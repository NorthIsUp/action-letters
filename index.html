<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SF Letter Templates</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        html, body {
            @apply h-full overflow-auto overscroll-none;
        }
        @layer components {
            .prose {
                @apply max-w-none;
            }
            .prose h1 {
                @apply text-3xl font-bold mb-4;
            }
            .prose p {
                @apply mb-4;
            }
            .prose ul {
                @apply list-disc pl-5 mb-4;
            }
            .prose li {
                @apply mb-1;
            }
            .editable-section {
                @apply relative border border-dashed border-gray-300 p-1 sm:p-4 rounded-md hover:border-blue-400 transition-colors;
            }
            .editable-section::before {
                content: attr(data-edit-message);
                @apply absolute -top-3 right-2 text-sm text-gray-500 bg-white px-2 pointer-events-none;
            }
            .editable-section:focus-within::before {
                content: 'Editing...';
                @apply text-blue-500;
            }
            .editable-section .content {
                @apply min-h-[200px];
            }
            .editable-section textarea {
                @apply block w-full min-h-[200px] opacity-0 p-1 sm:p-4 cursor-text;
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
            }
            .editable-section:focus-within {
                @apply ring-2 ring-blue-500 border-transparent;
            }
            .editable-section:focus-within .content {
                @apply opacity-30;
            }
            .editable-section:focus-within textarea {
                @apply opacity-100;
                position: relative;
            }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Letter List View -->
    <div id="letterList" class="p-6">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-3xl font-bold text-gray-900 mb-6">SF Letter Templates</h1>
            
            <div class="bg-white rounded-lg shadow-md p-6 mb-8">
                <h2 class="text-xl font-semibold text-gray-900 mb-4">Instructions</h2>
                <div class="prose text-gray-600">
                    <p class="mb-4">
                        These letter templates help you communicate effectively with city officials about important community issues. Each template:
                    </p>
                    <ul class="list-disc pl-5 mb-4 space-y-2">
                        <li>Is pre-addressed to relevant city officials</li>
                        <li>Contains carefully researched information and specific requests</li>
                        <li>Can be customized with your personal details and additional concerns</li>
                        <li>Will open in your default email client when you click "Send"</li>
                    </ul>
                    <p class="mb-4">
                        To use a template: select recipients, add your contact information, review and edit the letter content if desired, then click "Send" to open your email client with the completed letter.
                    </p>
                </div>
                <details class="mt-6 border-t pt-4">
                    <summary class="font-medium text-gray-900 cursor-pointer hover:text-blue-600">
                        Saved Contact Information
                    </summary>
                    <div class="mt-4 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Your Name:</label>
                                <input type="text" id="global_signature" 
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Your Email:</label>
                                <input type="email" id="global_email"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-gray-700 mb-1">
                                    Your Address: <span class="text-gray-500 text-xs">(optional)</span>
                                </label>
                                <input type="text" id="global_address"
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder="Street address, City, State ZIP">
                            </div>
                        </div>
                    </div>
                </details>
            </div>
            
            <div class="bg-white rounded-lg shadow-md p-6">
                <div class="space-y-6">
                    <div>
                        <h2 class="text-xl font-semibold text-gray-900 mb-4">Available Letters</h2>
                        <div id="letterCards" class="space-y-4">
                            <!-- Letter cards will be inserted here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Letter Editor View (initially hidden) -->
    <div id="letterEditor" class="hidden p-2 sm:p-6">
        <div class="sm:max-w-7xl sm:mx-auto">
            <div class="flex justify-between items-center mb-6">
                <button onclick="showLetterList()" class="flex items-center text-blue-600 hover:text-blue-800">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
                    </svg>
                    Back to Letters
                </button>
                <button onclick="resetLetter()" class="flex items-center text-gray-600 hover:text-gray-800">
                    <svg class="w-5 h-5 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    Reset
                </button>
            </div>

            <div class="bg-white rounded-lg shadow-md p-1 sm:p-6 w-full">
                <div class="prose max-w-none" id="letterContainer">
                    <!-- Letter content will be rendered here -->
                </div>
            </div>

            <!-- Send Section -->
            <div class="mt-2 sm:mt-6 bg-white rounded-lg shadow-md p-3 sm:p-6">
                <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2">Select Recipients:</label>
                    <div id="recipientCheckboxes">
                        <!-- Checkboxes will be inserted here -->
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
                    <div>
                        <label for="signature" class="block text-sm font-medium text-gray-700 mb-1">Your Name:</label>
                        <input type="text" id="signature" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 invalid:border-red-500">
                    </div>
                    
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Your Email:</label>
                        <input type="email" id="email" required
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 invalid:border-red-500">
                        <div id="emailError" class="mt-1 text-sm text-red-600 hidden"></div>
                    </div>

                    <div class="md:col-span-2">
                        <label for="address" class="block text-sm font-medium text-gray-700 mb-1">
                            Your Address: <span class="text-gray-500 text-xs">(optional)</span>
                        </label>
                        <input type="text" id="address"
                            class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            placeholder="Street address, City, State ZIP">
                    </div>
                </div>

                <button onclick="sendLetter(event)"
                    class="w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors">
                    Send Letter
                </button>
            </div>
        </div>
    </div>

    <!-- Include the rest of your JavaScript in a separate file -->
    <script src="letter-editor.js" defer></script>
</body>
</html>
